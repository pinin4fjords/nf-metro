%%metro title: Complex Multipath
%%metro style: dark
%%metro line: fast | Fast Path | #e63946
%%metro line: standard | Standard Path | #2db572
%%metro line: detailed | Detailed Analysis | #0570b0
%%metro line: legacy | Legacy Path | #f5c542

graph LR
    subgraph input_sec [Input]
        %%metro exit: right | fast, standard, detailed, legacy
        raw[Raw Data]
        validate[Validate]
        raw -->|fast,standard,detailed,legacy| validate
    end

    subgraph fast_track [Fast Track]
        %%metro entry: left | fast
        %%metro exit: right | fast
        quick_align[Quick Align]
        quick_quant[Quick Quant]
        quick_align -->|fast| quick_quant
    end

    subgraph full_preprocess [Full Pre-process]
        %%metro entry: left | standard, detailed, legacy
        %%metro exit: right | standard, detailed, legacy
        trim[Trim]
        filter[Filter]
        qc_check[QC Check]
        trim -->|standard,detailed,legacy| filter
        filter -->|standard,detailed,legacy| qc_check
    end

    subgraph standard_analysis [Standard Analysis]
        %%metro entry: left | standard, legacy
        %%metro exit: right | standard, legacy
        align[Align]
        quant[Quantify]
        align -->|standard,legacy| quant
    end

    subgraph deep_analysis [Deep Analysis]
        %%metro entry: left | detailed
        %%metro exit: right | detailed
        hq_align[HQ Align]
        dedup[Dedup]
        hq_quant[HQ Quantify]
        hq_align -->|detailed| dedup
        dedup -->|detailed| hq_quant
    end

    subgraph output_sec [Output]
        %%metro entry: left | fast, standard, detailed, legacy
        aggregate[Aggregate]
        report[Report]
        aggregate -->|fast,standard,detailed,legacy| report
    end

    validate -->|fast| quick_align
    validate -->|standard,detailed,legacy| trim
    qc_check -->|standard,legacy| align
    qc_check -->|detailed| hq_align
    quick_quant -->|fast| aggregate
    quant -->|standard,legacy| aggregate
    hq_quant -->|detailed| aggregate
